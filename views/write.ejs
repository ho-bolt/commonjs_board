<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
crossorigin="anonymous"></script>

<title>항해 99 블로그 작성페이지</title>

<script>

function writeBoard() {
    let title = $('#title').val();
    let userName = $('#userName').val()
    let password = $('#password').val()
    let content = $('#content').val()
    console.log(1)
    $.ajax({
        type: "POST",
        url: "/board",
        data: {
            title: title,
            userName: userName,
            password: password,
            content: content
        },
        success: function (response) {
            alert(response['msg'])
            window.location.href = '/board'
        }
    })
}

function updateBoard(boardId) {
    let title = $('#title').val()
    let userName = $('#userName').val()
    let password = $('#password').val()
    let content = $('#content').val()


    $.ajax({
        type: "PUT",
        url: "/board/" + boardId,
        data: {
            title,
            userName,
            password,
            content
        },
        success: function (response) {
            if (response['success'] === true) {
                alert(response['msg'])
                window.location.href = "/board"
            } else {
                alert(response['msg'])
            }

        }

    })
}

function deleteBoard(boardId) {
    let password = $('#password').val()
    $.ajax({

        type: "DELETE",
        url: "/board/" + boardId,
        data: { password },

        success: function (response) {
            if (response['success'] === true) {
                alert(response['msg'])
                window.location.href = '/board'
               
            } else {
                alert(response['msg'])
            }

        }

    })
}


</script>
</head>

<body>

        <div class="nav">
            <div> 
                <h2>글쓰기</h2>
            </div>
           
         
        </div>
        <!-- 첨 작성할 때  -->
        <%if(locals.board ) {%>
        <div class="write_form">
            <form class="box" id="write_board" method="post" action="javascript:updateBoard(<%=board.boardId%>)">
                <div class="field">
                <label class="label">TITLE</label>
                <div class="control">
                    <input class="input" id="title" type="text" placeholder="TITLE" value="<%=board.title %>">
                </div>
                </div>

                <div class="field">
                    <label class="label">CONTENT</label>
                    <div class="control">
                        <textarea class="textarea" id="content"  rows="10"><%= board.content %></textarea>
                    </div>
                </div>

                <div class="field">
                    <label class="label">USER NAME</label>
                    <div class="control">
                        <input class="input" id="userName" type="text" placeholder="USER NAME" value="<%=board.userName %>">
                    </div>
                </div>          
                <div class="field">
                    <label class="label">PASSWORD</label>
                    <div class="control">
                    <input class="input" id="password" type="password" placeholder="********">
                    </div>
                </div>
               
            </form>
        </div>

        <% }else { %>

        <!--작성하기 -->
        <div class="write_form">
            <form class="box" id="write_board" action="javascript:writeBoard()">
                <div class="field">
                <label class="label">TITLE</label>
                <div class="control">
                    <input class="input" id="title" type="text" placeholder="TITLE">
                </div>
                </div>

                <div class="field">
                    <label class="label">CONTENT</label>
                    <div class="control">
                        <textarea class="textarea" id="content" placeholder="CONTENT" rows="10"></textarea>
                    </div>
                </div>

                <div class="field">
                    <label class="label">USER NAME</label>
                    <div class="control">
                        <input class="input" id="userName" type="text" placeholder="USER NAME">
                    </div>
                </div>
            

                <div class="field">
                    <label class="label">PASSWORD</label>
                    <div class="control">
                    <input class="input" id="password" type="password" placeholder="********">
                    </div>
                </div>

            </form>
        </div>
            <% }%>
            <div class="btn_area">
    <% if(locals.board) {%>
       
        <button type="submit" class="btn btn-warning" form="write_board">수정완료</button>
        <button type="button" class="btn btn-danger"onclick="deleteBoard(<%=board.boardId%>)">삭제</button>
        <% }else { %>
            <button type="submit" class="btn btn-success" form="write_board">작성하기</button>       
        <%}%>
    </div>
    </div>
</body>

</html>


